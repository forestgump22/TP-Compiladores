grammar SimpleCppWithOverloading;

// Programa principal
program : structDeclaration+ ;

// Declaración de estructuras
structDeclaration
    : 'struct' ID '{' structField* operatorOverload* '}' ';'
    ;

// Campos de la estructura
structField
    : type ID ';'
    ;

// Sobrecarga de operadores
operatorOverload
    : 'operator' overloadableOperator '(' type ID ')' block
    ;

// Operadores que se pueden sobrecargar
overloadableOperator
    : '+' | '-' | '*' | '/' | '==' | '!=' | '<' | '>' | '&&' | '||'
    ;

// Asignación de miembros
assignment
    : ID ('.' ID)* '=' expr ';'
    ;

// Expresiones
expr
    : expr overloadableOperator expr  // Expresiones con operadores sobrecargados
    | '(' expr ')'                   // Expresiones entre paréntesis
    | ID ('.' ID)*                   // Acceso a miembros de estructuras
    | NUM
    | STRING
    ;

// Declaración de un bloque de código
block
    : '{' stat* '}'
    ;

// Declaraciones
stat
    : assignment
    | returnStat
    | expr ';'
    ;

// Manejo de return
returnStat
    : 'return' expr ';'
    ;

// Tipos de datos
type
    : 'int'
    | 'float'
    | 'char'
    | 'bool'
    | 'string'
    | ID                              // Para soportar tipos definidos por el usuario (como Vector)
    ;

// Tokens
ID  : [a-zA-Z_ñÑ][a-zA-Z0-9_ñÑ]* ;           // Identificadores
NUM : [0-9]+ ('.' [0-9]+)? ;                  // Números
STRING : '"' (~["\\] | '\\' .)* '"' ;          // Literales de cadena
WS  : [ \t\n\r]+ -> skip ;    
